$watcher = New-Object System.IO.FileSystemWatcher('C:\temp','*.*')
$watcher.EnableRaisingEvents = $true

$action = {
	Write-Host $event.SourceArgs.FullPath -Fore Green
	if($flag){
		#Start-Process cmd.exe '/c D:\Users\xfirebg\Desktop\excel\append.cmd'
		$global:flag = $false
		Write-Host 'Email sent' -ForegroundColor Green
    }
}

$fswArguments = @{
	EventName		  = 'Created'
	SourceIdentifier  = 'FileCreated'
	InputObject	      = $watcher
	Action		      = $action
}

$flag = $true
$job = Register-ObjectEvent @fswArguments

#while ($true) { Start-Sleep 20 }
#Unregister-Event $job.Name